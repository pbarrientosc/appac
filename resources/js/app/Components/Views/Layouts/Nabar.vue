<template>
    <app-navbar :logo-url="logo"
                :user="user.loggedInUser"
                :selected-language="userLanguage"
                :language-data="languageList"
                :profile-data="profileData"
                all-notification-url="/all-notifications"
                />
</template>

<script>
    import {UserMixin} from '../Auth/Mixins/UserMixin';
    import * as actions from '../../../Config/ApiUrl';
    import {axiosPost} from "../../../Helpers/AxiosHelper";
    import {mapActions} from "vuex";
    import AppFunction from "../../../../core/helpers/app/AppFunction";

    export default {
        name : 'DashboardNavbar',
        mixins: [UserMixin],
        props: {
            logo: {
                type: String,
                default: AppFunction.getAppUrl('images/icon.png')
            }
        },
        data(){
            return{
                profileData: [
                    {
                        optionName: 'Mi perfil',
                        optionIcon: 'user',
                        url: actions.MY_PROFILE
                    },
                    {
                        optionName: 'Ajustes',
                        optionIcon: 'settings',
                        url: actions.APP_SETTINGS
                    },
                    {
                        optionName: 'Cerrar sesiÃ³n',
                        optionIcon: 'log-out',
                        url: actions.LOGOUT
                    },
                ]
            }
        },
        created() {
            this.$store.dispatch('getSettings');
            // this.$store.dispatch('getNotifications');
            this.$store.dispatch('setSelectedLanguage');
            this.$store.dispatch('getUser');
            this.$store.dispatch('getLanguages');
        },
        computed: {
            languageList() {
                return this.$store.state.settings.languages
            },
            userLanguage() {
                return window.localStorage.getItem('app-language').toUpperCase()
            },
            showIdentifier() {
                const notifications = this.$store.getters.notificationList;
                return !(notifications && notifications.length && notifications.total_unread) ? false : true;
            }
        },

        methods: {
            // ...mapActions([
            //     'getNotifications'
            // ]),
            // readNotification(notification) {
            //     axiosPost(`admin/user/notifications/mark-as-read/${notification.id}`).then(({data}) => {
            //         if (data.data.url) {
            //             window.location = data.data.url;
            //         }
            //         this.getNotifications();
            //     });
            // }
        }
    }
</script>
